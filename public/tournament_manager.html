<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Tournaments</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        * { font-family: 'Nunito', sans-serif; }

        body {
            background: #f0f4ff;
            min-height: 100vh;
        }

        /* ---- HEADER ---- */
        .hero {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 45px 20px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: "";
            position: absolute;
            top: -60px; right: -60px;
            width: 220px; height: 220px;
            background: rgba(255,255,255,0.08);
            border-radius: 50%;
        }
        .hero::after {
            content: "";
            position: absolute;
            bottom: -80px; left: -40px;
            width: 280px; height: 280px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }
        .hero h1 {
            font-size: 2.6rem;
            font-weight: 900;
            color: #fff;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }
        .hero p {
            color: rgba(255,255,255,0.75);
            font-size: 1rem;
            margin: 0;
        }

        /* ---- FILTER BAR ---- */
        .filter-wrap {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(102,126,234,0.15);
            padding: 25px 30px;
            margin: -25px auto 35px;
            max-width: 780px;
            position: relative;
            z-index: 10;
        }
        .filter-label {
            font-size: 0.78rem;
            font-weight: 700;
            color: #667eea;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 6px;
        }
        .form-select {
            border: 2px solid #e8ecff;
            border-radius: 12px;
            padding: 10px 15px;
            font-size: 0.9rem;
            color: #333;
            font-weight: 600;
            background-color: #f8f9ff;
            transition: border-color 0.2s;
        }
        .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.15);
        }
        .btn-find {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            font-weight: 800;
            border: none;
            border-radius: 12px;
            padding: 11px 28px;
            font-size: 0.95rem;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
            letter-spacing: 0.5px;
        }
        .btn-find:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102,126,234,0.45);
            color: #fff;
        }

        /* ---- SECTION TITLE ---- */
        .section-title {
            font-size: 1rem;
            font-weight: 700;
            color: #555;
            margin-bottom: 20px;
            padding-left: 5px;
        }
        .section-title span {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border-radius: 20px;
            padding: 3px 12px;
            font-size: 0.85rem;
            margin-left: 8px;
        }

        /* ---- CARDS ---- */
        .t-card {
            background: #fff;
            border-radius: 18px;
            padding: 22px;
            box-shadow: 0 4px 15px rgba(102,126,234,0.1);
            border: 2px solid transparent;
            transition: all 0.25s;
            height: 100%;
        }
        .t-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(102,126,234,0.2);
        }
        .sport-pill {
            display: inline-block;
            background: #f0f4ff;
            color: #667eea;
            border-radius: 20px;
            padding: 4px 14px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 12px;
            border: 1.5px solid #e8ecff;
        }
        .t-card h5 {
            font-size: 1.05rem;
            font-weight: 800;
            color: #2d2d2d;
            margin-bottom: 6px;
        }
        .t-card .city-text {
            color: #888;
            font-size: 0.85rem;
            margin-bottom: 16px;
            font-weight: 600;
        }
        .btn-details {
            background: #f0f4ff;
            color: #667eea;
            border: 2px solid #e8ecff;
            border-radius: 10px;
            padding: 8px 0;
            font-size: 0.85rem;
            font-weight: 700;
            width: 100%;
            transition: all 0.2s;
        }
        .btn-details:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border-color: transparent;
        }

        /* ---- EMPTY / INITIAL STATE ---- */
        .state-box {
            text-align: center;
            padding: 60px 20px;
            color: #aaa;
        }
        .state-box .icon { font-size: 3.5rem; margin-bottom: 15px; }
        .state-box p { font-size: 1rem; color: #999; line-height: 1.7; }
        .state-box strong { color: #667eea; }

        /* ---- MODAL ---- */
        .modal-content {
            border-radius: 20px;
            border: none;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        .modal-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            padding: 20px 25px;
        }
        .modal-header .modal-title {
            color: #fff;
            font-weight: 800;
            font-size: 1.15rem;
        }
        .modal-header .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
        }
        .modal-body { padding: 20px 25px; background: #fff; }
        .detail-item {
            display: flex;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
            align-items: flex-start;
        }
        .detail-item:last-child { border-bottom: none; }
        .detail-icon {
            font-size: 1rem;
            min-width: 24px;
            text-align: center;
            margin-top: 2px;
        }
        .detail-key {
            font-size: 0.78rem;
            font-weight: 700;
            color: #667eea;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 145px;
        }
        .detail-val {
            font-size: 0.9rem;
            color: #333;
            font-weight: 600;
        }
        .modal-footer {
            background: #f8f9ff;
            border-top: 1px solid #eef;
            padding: 15px 25px;
        }
        .btn-close-mod {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 9px 28px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        @media (max-width: 576px) {
            .hero h1 { font-size: 1.8rem; }
            .filter-wrap { margin: -20px 15px 25px; padding: 18px; }
        }
    </style>

    <script>
        var mymodule = angular.module("kuchModule", []);

        mymodule.controller("kuchController", function ($scope, $http) {
            $scope.jsonArray = [];
            $scope.selCity = "none";
            $scope.selGame = "none";
            $scope.searched = false;

            $scope.doFetchAll = function () {
                var city = ($scope.selCity && $scope.selCity !== "none") ? $scope.selCity.trim() : "";
                var game = ($scope.selGame && $scope.selGame !== "none") ? $scope.selGame.trim() : "";
                var url = "/do-fetch-all-tournaments?kuchCity=" + city + "&kuchGame=" + game;

                $http.get(url).then(function (response) {
                    $scope.jsonArray = response.data;
                    $scope.searched = true;
                }, function (response) {
                    alert("Error: " + JSON.stringify(response.data));
                });
            };

            $scope.cities = [];
            $scope.doFetchAlCities = function () {
                $http.get("/do-fetch-all-cities").then(function (response) {
                    $scope.cities = response.data;
                }, function (response) {
                    alert("Error fetching cities: " + JSON.stringify(response.data));
                });
            };

            $scope.oneRecord = {};
            $scope.doShowDetails = function (index) {
                $scope.oneRecord = $scope.jsonArray[index];
            };
        });
    </script>
</head>

<body ng-app="kuchModule" ng-controller="kuchController" ng-init="doFetchAlCities();">

    <!-- HEADER -->
    <div class="hero">
        <h1>üèÜ All Tournaments</h1>
        <p>Discover & join tournaments happening near you</p>
    </div>

    <div class="container">

        <!-- FILTER BAR -->
        <div class="filter-wrap">
            <div class="row g-3 align-items-end">
                <div class="col-12 col-sm-4">
                    <div class="filter-label">üéÆ Sport</div>
                    <select ng-model="selGame" class="form-select">
                        <option value="none">All Sports</option>
                        <option value="Football">Football</option>
                        <option value="Cricket">Cricket</option>
                        <option value="Basketball">Basketball</option>
                        <option value="Tennis">Tennis</option>
                        <option value="Badminton">Badminton</option>
                        <option value="Baseball">Baseball</option>
                        <option value="Hockey">Hockey</option>
                        <option value="Volleyball">Volleyball</option>
                        <option value="Golf">Golf</option>
                        <option value="Marathon">Marathon</option>
                    </select>
                </div>
                <div class="col-12 col-sm-4">
                    <div class="filter-label">üìç City</div>
                    <select ng-model="selCity" class="form-select">
                        <option value="none">All Cities</option>
                        <option ng-repeat="obj in cities" value="{{obj.eventCity}}">{{obj.eventCity}}</option>
                    </select>
                </div>
                <div class="col-12 col-sm-4">
                    <div class="filter-label" style="opacity:0;">_</div>
                    <button class="btn-find" ng-click="doFetchAll();">üîç Find Tournaments</button>
                </div>
            </div>
        </div>

        <!-- RESULTS COUNT -->
        <div class="section-title" ng-if="searched && jsonArray.length > 0">
            Tournaments Found <span>{{jsonArray.length}}</span>
        </div>

        <!-- CARDS -->
        <div class="row g-4 pb-5" ng-if="jsonArray.length > 0">
            <div class="col-12 col-sm-6 col-lg-4 col-xl-3" ng-repeat="obj in jsonArray">
                <div class="t-card">
                    <div class="sport-pill">‚öΩ {{obj.eventSport}}</div>
                    <h5>{{obj.eventTitle}}</h5>
                    <p class="city-text">üìç {{obj.eventCity}}</p>
                    <button class="btn-details" data-bs-toggle="modal" data-bs-target="#detailsModal"
                        ng-click="doShowDetails($index);">View Details ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- NO RESULTS -->
        <div class="state-box" ng-if="searched && jsonArray.length === 0">
            <div class="icon">üèüÔ∏è</div>
            <p>No tournaments found for selected filters.<br>Try a different sport or city.</p>
        </div>

        <!-- INITIAL STATE -->
        <div class="state-box" ng-if="!searched">
            <div class="icon">üîç</div>
            <p>Select a sport and city above,<br>then click <strong>Find Tournaments</strong> to get started!</p>
        </div>

    </div>

    <!-- MODAL -->
    <div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">üèÜ Tournament Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="detail-item">
                        <div class="detail-icon">üè∑Ô∏è</div>
                        <div>
                            <div class="detail-key">Event Title</div>
                            <div class="detail-val">{{oneRecord.eventTitle}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">‚öΩ</div>
                        <div>
                            <div class="detail-key">Sport</div>
                            <div class="detail-val">{{oneRecord.eventSport}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üìç</div>
                        <div>
                            <div class="detail-key">City</div>
                            <div class="detail-val">{{oneRecord.eventCity}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üìÖ</div>
                        <div>
                            <div class="detail-key">Posted Date</div>
                            <div class="detail-val">{{oneRecord.eventDate}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">‚è∞</div>
                        <div>
                            <div class="detail-key">Time of Event</div>
                            <div class="detail-val">{{oneRecord.eventTime}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üë§</div>
                        <div>
                            <div class="detail-key">Age Group</div>
                            <div class="detail-val">{{oneRecord.eventmin}} ‚Äì {{oneRecord.eventmax}} years</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üìÜ</div>
                        <div>
                            <div class="detail-key">Last Date to Register</div>
                            <div class="detail-val">{{oneRecord.eventlast}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üí∞</div>
                        <div>
                            <div class="detail-key">Entry Fees</div>
                            <div class="detail-val">‚Çπ {{oneRecord.eventfee}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üèÖ</div>
                        <div>
                            <div class="detail-key">Prize Money</div>
                            <div class="detail-val">‚Çπ {{oneRecord.eventmoney}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">üìû</div>
                        <div>
                            <div class="detail-key">Contact</div>
                            <div class="detail-val">{{oneRecord.eventcnt}}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">‚úâÔ∏è</div>
                        <div>
                            <div class="detail-key">Organizer Email</div>
                            <div class="detail-val">{{oneRecord.eventEmail}}</div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-close-mod" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>